"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_17_elec <- rbind(pge_17_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_17_elec, "pge_17_elec.rds")
}
year <- 2018
quarters <- 1:4
type <- "Electric"
pge_20_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_18_elec <- rbind(pge_18_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_18_elec, "pge_18_elec.rds")
}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
year <- 2017
quarters <- 1:4
type <- "Electric"
pge_17_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_17_elec <- rbind(pge_17_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_17_elec, "pge_17_elec.rds")
}
year <- 2018
quarters <- 1:4
type <- "Electric"
pge_18_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_18_elec <- rbind(pge_18_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_18_elec, "pge_18_elec.rds")
}
library(tidyverse)
year <- 2019
quarters <- 1:4
type <- "Electric"
pge_19_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_19_elec <- rbind(pge_19_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_19_elec, "pge_19_elec.rds")
}
library(tidyverse)
year <- 2020
quarters <- 1:4
type <- "Electric"
pge_20_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_20_elec <- rbind(pge_20_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_20_elec, "pge_20_elec.rds")
}
year <- 2021
quarters <- 1:2
type <- "Electric"
pge_21_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_21_elec <- rbind(pge_21_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_21_elec, "pge_21_elec.rds")
}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
year <- 2017
quarters <- 1:4
type <- "Electric"
pge_17_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_17_elec <- rbind(pge_17_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_17_elec, "pge_17_elec.rds")
}
year <- 2018
quarters <- 1:4
type <- "Electric"
pge_18_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_18_elec <- rbind(pge_18_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_18_elec, "pge_18_elec.rds")
}
library(tidyverse)
year <- 2019
quarters <- 1:4
type <- "Electric"
pge_19_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_19_elec <- rbind(pge_19_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_19_elec, "pge_19_elec.rds")
}
library(tidyverse)
year <- 2020
quarters <- 1:4
type <- "Electric"
pge_20_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_20_elec <- rbind(pge_20_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_20_elec, "pge_20_elec.rds")
}
year <- 2021
quarters <- 1:2
type <- "Electric"
pge_21_elec <- NULL
for(quarter in quarters) {
filename <-
paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_21_elec <- rbind(pge_21_elec,temp)
# Note rbind requires field names to be consistent for every new thing that you add.
saveRDS(pge_21_elec, "pge_21_elec.rds")
}
pge_filter17 <- filter(pge_17_elec, CUSTOMERCLASS %in% c("Elec- Residential","Elec- Commercial"))
pge_filter18 <- filter(pge_18_elec, CUSTOMERCLASS %in% c("Elec- Residential","Elec- Commercial"))
pge_filter19 <- filter(pge_19_elec, CUSTOMERCLASS %in% c("Elec- Residential","Elec- Commercial"))
pge_filter20 <- filter(pge_20_elec, CUSTOMERCLASS %in% c("Elec- Residential","Elec- Commercial"))
pge_filter21 <- filter(pge_21_elec, CUSTOMERCLASS %in% c("Elec- Residential","Elec- Commercial"))
pge_filter21 <-
filter(
pge_21_elec,
CUSTOMERCLASS %in%
c(
"Elec- Residential",
"Elec- Commercial"
)
)
head(pge_filter21)
pge_filter21 <-
filter(
pge_21_elec,
CUSTOMERCLASS %in%
c(
"Elec- Residential",
"Elec- Commercial"
)
)
head(pge_filter21)
View(pge_filter21)
View(pge_filter21)
library(tidyverse)
years <- 2017:2021
quarters <- 1:4
type <- c("Electric", "Gas")
pge_year_elec <- NULL
pge_year_gas <- NULL
for(year in years){
for(quarter in quarters) {
for(type in types){
filename <- paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
##skip quarters 3 and 4 of year 2021
if((year == 2021)& (quarter %in% 3:4))next
temp <- read_csv(filename)
if(type == "Electric"){
temp <- temp %>%
mutate(TOTALKBTU = colname * number) %>%  ##conversion rate
## remove the KWH
if(type == "Gas"){
}
pge_data <- rbind(pge_year_data,temp)
saveRDS(pge_data, "pge_data.rds")
}
}
}
}
library(tidyverse)
years <- 2017:2021
quarters <- 1:4
types <- c("Electric", "Gas")
pge_data <- NULL
for(year in years){
for(quarter in quarters) {
for(type in types){
filename <- paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
##skip quarters 3 and 4 of year 2021
if((year == 2021)& (quarter %in% 3:4))next
## actually reading the data
temp <- read_csv(filename)
##converting the
if(type == "Electric"){
temp <- temp %>%
mutate(TOTALKBTU = TOTALKWH * 3.41214) %>%  ##conversion rate
select(-TOTALKWH,-AVERAGEKWH)
}
if(type == "Gas"){
temp <- temp %>%
mutate(TOTALKBTU = TOTALTHM * 99.9761) %>%
select(-TOTALTHM, -AVERAGETHM)
}
pge_data <- rbind(pge_data,temp)
saveRDS(pge_data, "pge_data.rds")
}
}
}
library(tidyverse)
years <- 2017:2021
quarters <- 1:4
types <- c("Electric", "Gas")
pge_data <- NULL
for(year in years){
for(quarter in quarters) {
for(type in types){
filename <- paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
##skip quarters 3 and 4 of year 2021
if((year == 2021)& (quarter %in% 3:4))next
## actually reading the data
temp <- read_csv(filename)
##converting the
if(type == "Electric"){
temp <- temp %>%
mutate(TOTALKBTU = TOTALKWH * 3.41214) %>%  ##conversion rate
select(-TOTALKWH,-AVERAGEKWH)
}
if(type == "Gas"){
temp <- temp %>%
mutate(TOTALKBTU = TOTALTHM * 99.9761) %>%
select(-TOTALTHM, -AVERAGETHM)
}
pge_data <- rbind(pge_data,temp)
saveRDS(pge_data, "pge_data.rds")
}
}
}
pge_chart <-
pge_final %>%
ggplot() +
geom_bar(
aes(
x = MONTH %>% factor(),
y = TOTALKWH,
fill = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Month",
y = "kWh",
title = "PG&E Territory Monthly Electricity Usage",
fill = "Electricity Type"
)
pge_chart <-
pge_data %>%
ggplot() +
geom_bar(
aes(
x = MONTH %>% factor(),
y = TOTALKBTU,
fill = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Month",
y = "kBTU",
title = "PG&E Territory Monthly Electricity Usage",
fill = "Electricity Type"
)
pge_chart <-
pge_data %>%
ggplot() +
geom_bar(
aes(
x = MONTH %>% factor(),
y = TOTALKBTU,
fill = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Month",
y = "kBTU",
title = "PG&E Territory Monthly Electricity Usage",
fill = "Electricity Type"
)
pge_chart
View(pge_chart)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
install.packages("plotly")
library(plotly)
years <- 2017:2021
quarters <- 1:4
types <- c("Electric", "Gas")
pge_data <- NULL
for(year in years){
for(quarter in quarters) {
for(type in types){
filename <- paste0(
"pge/PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
##show the file names
print(filename)
##skip quarters 3 and 4 of year 2021
if((year == 2021)& (quarter %in% 3:4))next
## actually reading the data
temp <- read_csv(filename)
##converting the units for electric column
if(type == "Electric"){
temp <- temp %>%
mutate(TOTALKBTU = TOTALKWH * 3.41214) %>%  ##conversion rate
select(-TOTALKWH,-AVERAGEKWH)
}
##converting the units for gas column
if(type == "Gas"){
temp <- temp %>%
mutate(TOTALKBTU = TOTALTHM * 99.9761) %>%
select(-TOTALTHM, -AVERAGETHM)
}
##bind and set the data
pge_data <- rbind(pge_data,temp)
saveRDS(pge_data, "pge_data.rds")
}
}
}
pge_filter <-
pge_data %>%
filter(
CUSTOMERCLASS %in% c("Gas- Commercial", "Elec- Commercial", "Gas- Residential", "Elec- Residential"),)
group_by(
MONTH,
YEAR,
CUSTOMERCLASS
)%>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = TRUE)
) %>%
mutate(
DATE =
paste(
YEAR,
MONTH,
"01",
sep = "-"
) %>% as.Date()
)
