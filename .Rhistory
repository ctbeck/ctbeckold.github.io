into = c(NA,NA,NA,"education"),
sep = "!!"
) %>%
group_by(education) %>%
summarize(across(everything(), sum)) %>%
filter(!is.na(education)) %>%
mutate(race = census_race_categories[x])
})
bay_race_total <-
bay_ed_race %>%
group_by(race) %>%
summarize(estimate = sum(estimate)) %>%
mutate(education = "Total")
bay_ed_race %>%
group_by(education, race) %>%
summarize(estimate = sum(estimate)) %>%
rbind(bay_race_total) %>%
ggplot() +
geom_bar(
aes(
x = education %>% factor(levels = rev(c("Total",unique(bay_ed_race$education)))),
y = estimate,
fill = race %>% factor(levels = rev(unique(bay_ed_race$race)))
),
stat = "identity",
position = "fill"
) +
labs(
x = "Educational Attainment",
y = "Proportion of Population 25 years or older",
title = "San Mateo County Educational Attainment by race",
fill = "Race"
) +
coord_flip() +
theme(
legend.position = "bottom",
legend.direction = "vertical"
)  +
guides(
fill = guide_legend(
reverse = T
)
)
bay_ed_race %>%
group_by(education, race) %>%
summarize(estimate = sum(estimate)) %>%
ggplot() +
geom_bar(
aes(
x = education,
y = estimate,
fill = race
),
stat = "identity",
position = "stack"
) +
labs(
x = "Educational Attainment",
y = "Proportion of Population 25 years or older",
title = "San Mateo County Educational Attainment by race",
fill = "Race"
) +
coord_flip()
library(tidyverse)
library(sf)
library(tigris)
library(censusapi)
library(mapview)
library(tidycensus)
library(leaflet)
library(readxl)
Sys.setenv(CENSUS_KEY ="c18a7f6e5cbbd1e7f0d3047d8b674cbaad89bcb3")
listCensusMetadata()
listCensusMetadata(
name = "2019/acs/acs1",
type = "variables"
)
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(sf)
library(tigris)
library(censusapi)
library(mapview)
library(tidycensus)
library(leaflet)
library(readxl)
Sys.setenv(CENSUS_KEY ="c18a7f6e5cbbd1e7f0d3047d8b674cbaad89bcb3")
acs_vars_2019_5yr <-
listCensusMetadata(
name = "2019/acs/acs5",
type = "variables"
)
listCensusMetadata(
name = "2019/acs/acs1",
type = "variables"
)
View(acs_vars_2019_5yr)
View(acs_vars_2010_5yr)
library(tidyverse)
library(sf)
library(tigris)
library(censusapi)
library(mapview)
library(tidycensus)
library(leaflet)
library(readxl)
Sys.setenv(CENSUS_KEY ="c18a7f6e5cbbd1e7f0d3047d8b674cbaad89bcb3")
acs_vars_2019_5yr <-
listCensusMetadata(
name = "2019/acs/acs5",
type = "variables"
)
acs_vars_2019_1yr <-
listCensusMetadata(
name = "2019/acs/acs1",
type = "variables"
)
View(acs_vars_2019_1yr)
census_ethnicity_categories <- data.frame(
code = c("H", "I"),
category =
c(
"White Not Latinx",
"Latinx"
)
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$letter[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
) %>%
select(-name) %>%
separate(
label,
into = c(NA,NA,NA,"education"),
sep = "!!"
) %>%
group_by(education) %>%
summarize(across(everything(), sum)) %>%
filter(!is.na(education)) %>%
mutate(ethnicity = census_ethnicity_categories[x])
})
census_ethnicity_categories <- data.frame(
code = c("H", "I"),
category =
c(
"White Not Latinx",
"Latinx"
)
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$letter[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
) %>%
select(-name) %>%
separate(
label,
into = c(NA,NA,NA,"education"),
sep = "!!"
) %>%
group_by(education) %>%
summarize(across(everything(), sum)) %>%
filter(!is.na(education)) %>%
mutate(ethnicity = census_ethnicity_categories[x])
})
View(census_ethnicity_categories)
census_ethnicity_categories <- data.frame(
code = c("H", "I"),
category =
c(
"White Not Latinx",
"Latinx"
)
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
) %>%
select(-name) %>%
separate(
label,
into = c(NA,NA,NA,"education"),
sep = "!!"
) %>%
group_by(education) %>%
summarize(across(everything(), sum)) %>%
filter(!is.na(education)) %>%
mutate(ethnicity = census_ethnicity_categories[x])
})
census_ethnicity_categories <- data.frame(
code = c("H", "I"),
category =
c(
"White Not Latinx",
"Latinx"
)
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
) %>%
select(-name) %>%
separate(
label,
into = c(NA,NA,NA,"education"),
sep = "!!"
) %>%
filter(!is.na(education)) %>%
mutate(ethnicity = census_ethnicity_categories[x])
})
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
) %>%
select(-name) %>%
separate(
label,
into = c(NA,NA,NA,"education"),
sep = "!!"
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
) %>%
select(-name) %>%
separate(
label,
into = c(NA,NA,NA,"education"),
sep = "!!"
) %>%
filter(!is.na(education))
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
) %>%
select(-name) %>%
separate(
label,
into = c(NA,NA,NA,"education"),
sep = "!!"
) %>%
filter(!is.na(education)) %>%
mutate(ethnicity = census_ethnicity_categories[x])
census_ethnicity_categories <- data.frame(
code = c("H", "I"),
category =
c(
"White Not Latinx",
"Latinx"
)
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
) %>%
select(-name) %>%
separate(
label,
into = c(NA,NA,NA,"education"),
sep = "!!"
) %>%
filter(!is.na(education)) %>%
mutate(ethnicity = census_ethnicity_categories$category[x])
})
census_ethnicity_categories <- data.frame(
code = c("H", "I"),
category =
c(
"White Not Latinx",
"Latinx"
)
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
) %>%
select(-name) %>%
separate(
label,
into = c(NA,NA,NA,"education"),
sep = "!!"
) %>%
filter(!is.na(education)) %>%
mutate(ethnicity = census_ethnicity_categories$category[x])
})
census_ethnicity_categories <- data.frame(
code = c("H", "I"),
category =
c(
"White Not Latinx",
"Latinx"
)
)
bay_ed_ethnicity <-
1:2 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs1",
vintage = 2019,
region = "county:085",
regionin = "state:06",
vars = paste0("group(C15002",census_ethnicity_categories$code[x],")")
) %>%
select(!c(GEO_ID,state,county,NAME) & !ends_with(c("EA","MA","M"))) %>%
pivot_longer(
ends_with("E"),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_1yr %>%
select(name, label)
) %>%
select(-name) %>%
separate(
label,
into = c(NA,NA,NA,"education"),
sep = "!!"
) %>%
filter(!is.na(education)) %>%
mutate(ethnicity = census_ethnicity_categories$category[x])
})
View(bay_ed_ethnicity)
